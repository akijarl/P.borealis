indmiss$INDV
View(indmiss)
indmiss$Sample<-samp2
indmiss<-indmiss[order(indmiss$F_MISS,decreasing = T),]
indmiss$Sample<-factor(indmiss$Sample,levels = indmiss$Sample)
ggplot(data=indmiss)+
geom_col(aes(x = Sample2, y = (F_MISS),fill=Year))+
ylab("Fraction of missing SNPs")+
theme_classic()+
theme(axis.text.x = element_text(angle = -45, vjust = 0.1,hjust = 0.1))
View(indmiss)
ggplot(data=indmiss)+
geom_col(aes(x = Sample, y = (F_MISS),fill=Year))+
ylab("Fraction of missing SNPs")+
theme_classic()+
theme(axis.text.x = element_text(angle = -45, vjust = 0.1,hjust = 0.1))
ggplot(data=indmiss)+
geom_col(aes(x = Sample, y = (F_MISS)))+
ylab("Fraction of missing SNPs")+
theme_classic()+
theme(axis.text.x = element_text(angle = -45, vjust = 0.1,hjust = 0.1))
colnames(geno_18)
colnames(geno_21)
cv18<-read.csv("admixture_CV_2018.csv")
ggplot(cv18[-1,])+
geom_line(aes(K,CV),size=1)+
#geom_vline(xintercept = 4,linetype="dashed")+
scale_x_continuous(breaks = c(1:15))+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
cv21<-read.csv("admixture_CV_2021.csv")
ggplot(cv21[-1,])+
geom_line(aes(K,CV),size=1)+
#geom_vline(xintercept = 4,linetype="dashed")+
scale_x_continuous(breaks = c(1:15))+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
tbl2_18=read.table("P.borealis_2018.2.Q")
pop2
pop2[1:36]
pop2[1:37]
pop2[1:36]
pop2[0:36]
tbl2_18=read.table("P.borealis_2018.2.Q")
tbl2_18$pop<-pop2[1:36]
tbl2_18$ind<-samp2[1:36]
row.names(tbl2)<-samp2[1:36]
row.names(tbl2_18)<-samp2[1:36]
tbl2_18=read.table("P.borealis_2018.2.Q")
tbl2_18$pop<-pop2[1:36]
tbl2_18$ind<-samp2[1:36]
row.names(tbl2_18)<-samp2[1:36]
tbl2_18<-tbl2_18[order(tbl2_18[,3],tbl2_18[,1],tbl2_18[,2]),]
tbl2_18<-tbl2_18[c(which(tbl2_18$pop=="SI18"),which(tbl2_18$pop=="SU18"),which(tbl2_18$pop=="SD18"),which(tbl2_18$pop=="AR18")),]
barplot(t(as.matrix(tbl2_18)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.names = 0.75)
warnings()
tbl2$pop
pop2[37:68]
pop2[37:69]
tbl2_21=read.table("P.borealis_2021.2.Q")
tbl2_21$pop<-pop2[37:68]
tbl2_21$ind<-samp2[37:68]
row.names(tbl2_21)<-samp2[37:68]
tbl2_21<-tbl2_21[order(tbl2_21[,3],tbl2_21[,1],tbl2_21[,2]),]
tbl2_21<-tbl2_21[c(which(tbl2_21$pop=="IS21"),which(tbl2_21$pop=="YS21"),which(tbl2_21$pop=="UH21")),]
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.names = 0.75)
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.names = 1.75)
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.names = 1.75,axis.lty = 2)
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.names = 1.75,cex.axis = 1.75)
?barplot
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.75,cex.axis = 1.75,)
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.5,cex.axis = 1.5,)
par(mar=c(15,4,4,2))
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.5,cex.axis = 1.5,)
par(mar=c(15,4,4,2))
dev.off()
par(mar=c(15,4,4,2))
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.5,cex.axis = 1.5,)
?par
par(mar=c(10,2,2,1))
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.5,cex.axis = 1.5,)
par(mar=c(10,3,1,1))
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.5,cex.axis = 1.5,)
par(mar=c(8,4,1,1))
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.5,cex.axis = 1.5,)
par(mar=c(8,4.4,1,0.5))
barplot(t(as.matrix(tbl2_21)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.5,cex.axis = 1.5,)
barplot(t(as.matrix(tbl2_18)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.5,cex.axis = 1.5,)
setwd("C:/Users/aki/Desktop/P.borealis")
require(ggplot2)
require(vcfR)
require(cowplot)
require(ggplot2)
require(ggrepel)
require(seqinr)
setwd("C:/Users/aki/Desktop/P.borealis/P.borealis/")
require(ggplot2)
require(vcfR)
require(cowplot)
require(ggplot2)
require(ggrepel)
require(seqinr)
tbl2=read.table("P.borealis_stacks.g5mac3dp10ind50g95maf05mdp20p1.recode.2.Q")
tbl2$pop<-pop2
tbl2$ind<-samp2
row.names(tbl2)<-samp2
tbl2<-tbl2[order(tbl2[,3],tbl2[,1],tbl2[,2]),]
tbl2<-tbl2[c(which(tbl2$pop=="SI18"),which(tbl2$pop=="SU18"),which(tbl2$pop=="SD18"),which(tbl2$pop=="IS21"),which(tbl2$pop=="YS21"),which(tbl2$pop=="UH21"),which(tbl2$pop=="AR18")),]
barplot(t(as.matrix(tbl2)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.names = 0.75)
barplot(t(as.matrix(tbl2)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = 1.5,cex.axis = 1.5)
barplot(t(as.matrix(tbl2)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = .75,cex.axis = 1.5)
tbl2=read.table("P.borealis_stacks.g5mac3dp10ind50g95maf05mdp20p1.recode.2.Q")
tbl2$pop<-pop2
tbl2$ind<-samp2
row.names(tbl2)<-samp2
tbl2<-tbl2[order(tbl2[,3],tbl2[,1],tbl2[,2]),]
tbl2<-tbl2[c(which(which(tbl2$pop=="AR18"),tbl2$pop=="SI18"),which(tbl2$pop=="SU18"),which(tbl2$pop=="SD18"),which(tbl2$pop=="IS21"),which(tbl2$pop=="YS21"),which(tbl2$pop=="UH21")),]
tbl2<-tbl2[c(which(which(tbl2$pop=="AR18",tbl2$pop=="SI18"),which(tbl2$pop=="SU18"),which(tbl2$pop=="SD18"),which(tbl2$pop=="IS21"),which(tbl2$pop=="YS21"),which(tbl2$pop=="UH21")),]
tbl2<-tbl2[c(which(which(tbl2$pop=="AR18",tbl2$pop=="SI18"),which(tbl2$pop=="SU18"),which(tbl2$pop=="SD18"),which(tbl2$pop=="IS21"),which(tbl2$pop=="YS21"),which(tbl2$pop=="UH21"))),]
tbl2<-tbl2[c(which(tbl2$pop=="AR18",which(tbl2$pop=="SI18"),which(tbl2$pop=="SU18"),which(tbl2$pop=="SD18"),which(tbl2$pop=="IS21"),which(tbl2$pop=="YS21"),which(tbl2$pop=="UH21"))),]
tbl2<-tbl2[c(which(tbl2$pop=="AR18",which(tbl2$pop=="SI18"),which(tbl2$pop=="SU18"),which(tbl2$pop=="SD18"),which(tbl2$pop=="IS21"),which(tbl2$pop=="YS21"),which(tbl2$pop=="UH21")),]
tbl2<-tbl2[c(which(tbl2$pop=="AR18"),which(tbl2$pop=="SI18"),which(tbl2$pop=="SU18"),which(tbl2$pop=="SD18"),which(tbl2$pop=="IS21"),which(tbl2$pop=="YS21"),which(tbl2$pop=="UH21")),]
barplot(t(as.matrix(tbl2)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = .75,cex.axis = 1.5)
tbl2<-tbl2[c(which(tbl2$pop=="AR18"),which(tbl2$pop=="SI18"),which(tbl2$pop=="SU18"),which(tbl2$pop=="IS21"),which(tbl2$pop=="SD18"),which(tbl2$pop=="YS21"),which(tbl2$pop=="UH21")),]
barplot(t(as.matrix(tbl2)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = .75,cex.axis = 1.5)
aggregate(V1~pop,tbl2,FUN=mean)
aggregate(V2~pop,tbl2,FUN=mean)
rbind(aggregate(V1~pop,tbl2,FUN=mean),aggregate(V2~pop,tbl2,FUN=mean))
cbind(aggregate(V1~pop,tbl2,FUN=mean),aggregate(V2~pop,tbl2,FUN=mean))
aggregate(V2~pop,tbl2,FUN=mean)
aggregate(V2~pop,tbl2,FUN=mean)$V2
data.frame(aggregate(V1~pop,tbl2,FUN=mean),aggregate(V2~pop,tbl2,FUN=mean)$V2)
?data.frame
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),aggregate(V2~pop,tbl2,FUN=mean)$V2,tag=c("pop","V1","V2"))
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),V2=aggregate(V2~pop,tbl2,FUN=mean)$V2,tag=c("pop","V1","V2"))
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),V2=aggregate(V2~pop,tbl2,FUN=mean)$V2)
View(tbl2)
View(Qmean)
barplot(t(as.matrix(Qmean)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = .75,cex.axis = 1.5)
t(as.matrix(tbl2))
t(as.matrix(Qmean))
t(as.matrix(tbl2))
class(t(as.matrix(tbl2)))
class(t(as.matrix(Qmean)))
str(t(as.matrix(tbl2)))
str(t(as.matrix(Qmean)))
class(tbl12)
str(t(as.matrix(tbl2)))
tbl2
class(tbl12)
class(tbl2)
(as.matrix(tbl2))
(as.matrix(Qmean))
row.names(Qmean)<-Qmean$pop
barplot(t(as.matrix(Qmean)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = .75,cex.axis = 1.5)
data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=Qmean$pop)
row.names(Qmean)<-Qmean$pop
barplot(t(as.matrix(Qmean)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = .75,cex.axis = 1.5)
barplot(t(as.matrix(Qmean)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA)
ggplot(data = Qmean)+
geom_col(aes(V1), col=c("blue","red"))
ggplot(data = Qmean)+
geom_bar(aes(V1), col=c("blue","red"))
ggplot(data = Qmean)+
geom_bar(aes(y=V1), colour=c("blue","red"))
ggplot(data = Qmean)+
geom_col(aes(y=V1), colour=c("blue","red"))
ggplot(data = Qmean)+
geom_col(aes(x=V1), colour=c("blue","red"))
ggplot(data = Qmean)+
geom_col(aes(x=pop), colour=c("blue","red"))
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V1), colour=c("blue","red"))
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V1))
Qmean[order(Qmean$V2),]
Qmean<-Qmean[order(Qmean$V2),]
Qname<-Qname[c(which(Qname$pop=="AR18"),which(Qname$pop=="SI18"),which(Qname$pop=="SU18"),which(Qname$pop=="IS21"),which(Qname$pop=="SD18"),which(Qname$pop=="YS21"),which(Qname$pop=="UH21")),]
Qmean<-Qmean[c(which(Qmean$pop=="AR18"),which(Qmean$pop=="SI18"),which(Qmean$pop=="SU18"),which(Qmean$pop=="IS21"),which(Qmean$pop=="SD18"),which(Qmean$pop=="YS21"),which(Qmean$pop=="UH21")),]
View(Qmean)
Qmean$pop
Qmean$pop<-as.factor(Qmean$pop,levels=Qmean$pop)
Qmean$pop<-as.factor(Qmean$pop,level=Qmean$pop)
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V1))
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2))+
theme_classic()
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=median),V2=aggregate(V2~pop,tbl2,FUN=median)$V2)
data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=Qmean$pop)
row.names(Qmean)<-Qmean$pop
Qmean<-Qmean[c(which(Qmean$pop=="AR18"),which(Qmean$pop=="SI18"),which(Qmean$pop=="SU18"),which(Qmean$pop=="IS21"),which(Qmean$pop=="SD18"),which(Qmean$pop=="YS21"),which(Qmean$pop=="UH21")),]
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2))+
theme_classic()
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),V2=aggregate(V2~pop,tbl2,FUN=mean)$V2)
data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=Qmean$pop)
row.names(Qmean)<-Qmean$pop
Qmean<-Qmean[c(which(Qmean$pop=="AR18"),which(Qmean$pop=="SI18"),which(Qmean$pop=="SU18"),which(Qmean$pop=="IS21"),which(Qmean$pop=="SD18"),which(Qmean$pop=="YS21"),which(Qmean$pop=="UH21")),]
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2))+
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="red")+
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=max),V2=aggregate(V2~pop,tbl2,FUN=max)$V2)
data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=Qmean$pop)
row.names(Qmean)<-Qmean$pop
Qmean<-Qmean[c(which(Qmean$pop=="AR18"),which(Qmean$pop=="SI18"),which(Qmean$pop=="SU18"),which(Qmean$pop=="IS21"),which(Qmean$pop=="SD18"),which(Qmean$pop=="YS21"),which(Qmean$pop=="UH21")),]
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=min),V2=aggregate(V2~pop,tbl2,FUN=min)$V2)
data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=Qmean$pop)
row.names(Qmean)<-Qmean$pop
Qmean<-Qmean[c(which(Qmean$pop=="AR18"),which(Qmean$pop=="SI18"),which(Qmean$pop=="SU18"),which(Qmean$pop=="IS21"),which(Qmean$pop=="SD18"),which(Qmean$pop=="YS21"),which(Qmean$pop=="UH21")),]
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),V2=aggregate(V2~pop,tbl2,FUN=mean)$V2)
data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=Qmean$pop)
row.names(Qmean)<-Qmean$pop
Qmean<-Qmean[c(which(Qmean$pop=="AR18"),which(Qmean$pop=="SI18"),which(Qmean$pop=="SU18"),which(Qmean$pop=="IS21"),which(Qmean$pop=="SD18"),which(Qmean$pop=="YS21"),which(Qmean$pop=="UH21")),]
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
barplot(t(as.matrix(tbl2)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = .75,cex.axis = 1.5)
Qmean$V2[1]
Qmean$V2[5]
Qmean$V2[6]
Qmean$V2[7]
Qmean$V2[8]
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_hline(yintercept = c(Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
?geom_line
Qmean
Qmean$pop[2:7]
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(aes(x=row.means(Qmean)[2:7],y=c(Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7]))) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(aes(x=row.names(Qmean)[2:7],y=c(Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7]))) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
row.names(Qmean)[2:7]
row.names(Qmean)[1:7]
c(Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(aes(x=row.names(Qmean)[2:7],y=c(Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7]))) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(data=Qmean,aes(x=row.names(Qmean)[2:7],y=c(Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7]))) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(inherit.aes = F,,aes(x=row.names(Qmean)[2:7],y=c(Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7]))) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(inherit.aes = F,aes(x=row.names(Qmean)[2:7],y=c(Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7]))) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(inherit.aes = F,aes(x=row.names(Qmean)[1:7],y=c(0,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7]))) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(aes(x=row.names(Qmean)[1:7],y=c(0,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7]))) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(aes(x=row.names(Qmean)[1:7],y=c(0,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(inherit.aes = F,aes(x=row.names(Qmean)[1:7],y=c(0,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(inherit.aes = F,aes(x=row.names(Qmean)[1:7],y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
Qmean$V2[2]
row.names(Qmean)[1:7]
c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])
ggplot()+
geom_col(data = Qmean,aes(x=pop,y=V2),fill="orange")+
geom_line(inherit.aes = F,aes(x=row.names(Qmean)[1:7],y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot()+
geom_col(data = Qmean,aes(x=pop,y=V2),fill="orange")+
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),V2=aggregate(V2~pop,tbl2,FUN=mean)$V2)
Qmean$pop
data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=c("AR","S3","S4","S1","S2","S5","S7","S6"))
c("AR","S3","S4","S1","S2","S5","S7","S6")
Qmean$pop
data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=c("AR","S3","S4","S1","S2","S6","S5"))
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),V2=aggregate(V2~pop,tbl2,FUN=mean)$V2)
Qmean
Qmean$pop
Qmean<-data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=c("AR","S3","S4","S1","S2","S6","S5"))
Qmean
row.names(Qmean)<-Qmean$pop
Qmean<-Qmean[c(which(Qmean$pop=="AR"),which(Qmean$pop=="S1"),which(Qmean$pop=="S2"),which(Qmean$pop=="S3"),which(Qmean$pop=="S4"),which(Qmean$pop=="S5"),which(Qmean$pop=="S6")),]
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
Qmean<-data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=c("AR","S3","S4","S1","S2","OS","S5"))
Qmean<-data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=c("AR","S3","S4","S1","S2","OS","S5"))
row.names(Qmean)<-Qmean$pop
Qmean<-Qmean[c(which(Qmean$pop=="AR"),which(Qmean$pop=="S1"),which(Qmean$pop=="S2"),which(Qmean$pop=="S3"),which(Qmean$pop=="S4"),which(Qmean$pop=="S5"),which(Qmean$pop=="OS")),]
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),V2=aggregate(V2~pop,tbl2,FUN=mean)$V2)
Qmean<-data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=c("AR","S3","S4","S1","S2","OS","S5"))
row.names(Qmean)<-Qmean$pop
Qmean<-Qmean[c(which(Qmean$pop=="AR"),which(Qmean$pop=="S1"),which(Qmean$pop=="S2"),which(Qmean$pop=="S3"),which(Qmean$pop=="S4"),which(Qmean$pop=="S5"),which(Qmean$pop=="OS")),]
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()
indmiss<-read.table("postfiltmiss.imiss",sep="\t",header = T)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
tbl2=read.table("P.borealis_stacks.g5mac3dp10ind50g95maf05mdp20p1.recode.2.Q")
tbl2$pop<-pop2
tbl2$ind<-samp2
row.names(tbl2)<-samp2
tbl2<-tbl2[order(tbl2[,3],tbl2[,1],tbl2[,2]),]
tbl2<-tbl2[c(which(tbl2$pop=="AR18"),which(tbl2$pop=="SI18"),which(tbl2$pop=="SU18"),which(tbl2$pop=="IS21"),which(tbl2$pop=="SD18"),which(tbl2$pop=="YS21"),which(tbl2$pop=="UH21")),]
barplot(t(as.matrix(tbl2)), col=c("blue","red"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = .75,cex.axis = 1.5)
barplot(t(as.matrix(tbl2)), col=c("red","blue"),xlab=NA, ylab="Ancestry", border=NA,las=2,cex.lab=1.5,cex.names = .75,cex.axis = 1.5)
#New filtered file
x<-read.vcfR("P.borealis_stacks.g5mac3dp10ind50g95maf05mdp20p1.recode.vcf")
getwd()
#New filtered file
x<-read.vcfR("../P.borealis_stacks.g5mac3dp10ind50g95maf05mdp20p1.recode.vcf")
Qmean$V2
Qmean$pop
unique(tbl2$pop)
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),V2=aggregate(V2~pop,tbl2,FUN=mean)$V2)
Qmean$pop
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,NA,NA,Qmean$V2[4],NA,Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
Qmean<-data.frame(aggregate(V1~pop,tbl2,FUN=mean),V2=aggregate(V2~pop,tbl2,FUN=mean)$V2)
Qmean<-data.frame(V1=Qmean$V1,V2=Qmean$V2,pop=c("AR","S3","S4","S1","S2","OS","S5"))
row.names(Qmean)<-Qmean$pop
Qmean<-Qmean[c(which(Qmean$pop=="AR"),which(Qmean$pop=="S1"),which(Qmean$pop=="S2"),which(Qmean$pop=="S3"),which(Qmean$pop=="S4"),which(Qmean$pop=="S5"),which(Qmean$pop=="OS")),]
Qmean$pop<-factor(Qmean$pop,level=Qmean$pop)
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,NA,NA,Qmean$V2[4],NA,Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
Qmean$V2[7]
Qmean$pop
Qmean$V2[4]
Qmean$V2[6]-Qmean$V2[4]
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,NA,NA,Qmean$V2[4],0.2031938,Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
Qmean$V2[4]
Qmean$V2[6]
Qmean$V2[4]-Qmean$V2[6]
Qmean$V2[6]-Qmean$V2[4]
sum(Qmean$V2[4],Qmean$V2[6]-Qmean$V2[4])
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,NA,NA,Qmean$V2[4],sum(Qmean$V2[4],Qmean$V2[6]-Qmean$V2[4]),Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,NA,NA,Qmean$V2[4],sum(Qmean$V2[4],(Qmean$V2[6]-Qmean$V2[4]/2)),Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,NA,NA,Qmean$V2[4],sum(Qmean$V2[4],(Qmean$V2[6]-Qmean$V2[4])/2),Qmean$V2[6],Qmean$V2[7])),group=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,NA,NA,Qmean$V2[4],sum(Qmean$V2[4],(Qmean$V2[6]-Qmean$V2[4])/2),Qmean$V2[6],Qmean$V2[7])),group=1,size=1) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,NA,NA,Qmean$V2[4],sum(Qmean$V2[4],(Qmean$V2[6]-Qmean$V2[4])/2),Qmean$V2[6],Qmean$V2[7])),group=1,size=2) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
ggplot(data = Qmean)+
geom_col(aes(x=pop,y=V2),fill="orange")+
#geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,Qmean$V2[2],Qmean$V2[3],Qmean$V2[4],Qmean$V2[5],Qmean$V2[6],Qmean$V2[7])),group=1) +
geom_line(inherit.aes = F,aes(x=Qmean$pop,y=c(NA,NA,NA,Qmean$V2[4],sum(Qmean$V2[4],(Qmean$V2[6]-Qmean$V2[4])/2),Qmean$V2[6],Qmean$V2[7])),group=1,size=1.5) +
xlab("")+
ylab("Mean outshore ancestry assignment")+
theme_classic()+
theme(axis.text=element_text(size=14),axis.title=element_text(size=14))
